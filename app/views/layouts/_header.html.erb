<header class="masthead hidden-xs">
  <div class="container">
    <div class="row">
      <div class="col-sm-6">
        <%= link_to image_tag("veb_logo.png", alt: "Vegan Eats Boston"), root_path, id: "logo", class: "logo-margin" %>
      </div>
      <div class="col-sm-6 pull-right masthead-right">
        <% if signed_in? %>
          <%= render 'shared/account_dropdown' %>
        <% else %>
          <%= link_to "Sign up now!", signup_path, class: "btn btn-default btn-success" %>
          <%= link_to "Sign in", signin_path, class: "btn btn-default btn-primary" %>
        <% end %>
      </div>
    </div>
  </div>
</header>

<div id="nav-wrapper">
  <nav id="nav">
    <div class="navbar navbar-default navbar-static-top" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#nav-links">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <span class="visible-xs-block">
          <%= link_to image_tag("veb_logo.png", alt: "Vegan Eats Boston"), root_path, id: "logo" %>
        </span>
      </div>
      <div class="navbar-collapse collapse" id="nav-links">
        <ul class="nav navbar-nav navbar-left">
          <li>
            <%= link_to "Home", root_path %>
          </li>
          <li>
            <%= link_to "Places", places_path, method: :get %>
          </li>
          <li>
            <%= link_to "Blog", blog_path %>
          </li>
          <li>
            <%= link_to "About",   about_path %>
          </li>
          <% if signed_in? %> 
            <li class="dropdown visible-xs">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <%= current_user.name %><b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li><%= link_to "Create Post", new_post_url %></li>
                <li><%= link_to "Create Place", new_place_path if current_user.admin? %></li>
                <li><%= link_to "Profile", current_user %></li>
                <li><%= link_to "Settings", edit_user_path(current_user) %></li>
                <li class="divider"></li>
                  <% if current_user.admin? %>
                    <li><%= link_to "Admin Page", admin_path %></li>
                    <li><%= link_to "New Admin Page", admin_dashboard_path %></li>
                    <li class="divider"></li>
                  <% end %>
                <li>
                  <%= link_to "Sign out", signout_path, method: "delete" %>
                </li>
              </ul>
            </li>
          <% else %>
            <li class="visible-xs"><%= link_to "Sign in", signin_path %></li>
            <li class="visible-xs"><%= link_to "Sign up", signup_path %></li>
          <% end %>
        </ul>
        <%= form_tag(places_path, :method =>  :get, id: "search-form", class: "navbar-form navbar-right", role: "search") do %>
          <div class="input-group">   
            <%= text_field_tag :search, nil, placeholder: "Search by address or name", class: "form-control nav-search" %>
            <span class="input-group-btn">
              <%= button_tag(type: 'submit', class: "btn btn-success") do %>
                <span class="glyphicon glyphicon-search"></span> 
              <% end %>
            </span>
          </div>
        <% end %>
      </div>
    </div>
    </div>
  </nav>
</div>

<script type="text/javascript">
  $('#nav').affix({
    offset: {
      top: $('header').height()
    }
  });
  $('#nav-wrapper').height($("#nav").height());

  $(window).resize(function(){
    if ($(window).width() < 767){  
      $('.nav-search').css("cssText", "width: 100% !important;");
    } else {
      $('.nav-search').css("cssText", "width: 400px !important;");
    }
  });
</script>
